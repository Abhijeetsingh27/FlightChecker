{"ast":null,"code":"import React,{useState,useEffect}from'react';import{useAuth}from'../hooks/useAuth';import{getBookingsByUserId}from'../services/api';import'./TripsAhead.css';import{jsx as _jsx,jsxs as _jsxs,Fragment as _Fragment}from\"react/jsx-runtime\";const TripsAhead=_ref=>{let{onClose}=_ref;const user=useAuth();const[bookings,setBookings]=useState([]);const[loading,setLoading]=useState(true);const[error,setError]=useState(null);useEffect(()=>{const fetchTrips=async()=>{if(!user){setLoading(false);setError(\"User not logged in.\");return;}setLoading(true);setError(null);try{// Fetch bookings for the logged-in user\n// Assuming getBookingsByUserId exists and takes user.id\nconst data=await getBookingsByUserId(user.id);setBookings(data);}catch(err){console.error('Error fetching trips:',err);setError('Failed to load your trips.');}finally{setLoading(false);}};// Only fetch if the user is logged in and the component is visible\nif(user){fetchTrips();}},[user]);// Refetch if user changes\nif(!user){// This case should ideally not be reached due to ProtectedRoute,\n// but handling it prevents errors if state is weird.\nreturn/*#__PURE__*/_jsx(\"div\",{className:\"trips-ahead-container error\",children:\"Please sign in to see your trips.\"});}if(loading){return/*#__PURE__*/_jsx(\"div\",{className:\"trips-ahead-container\",children:\"Loading trips...\"});}if(error){return/*#__PURE__*/_jsxs(\"div\",{className:\"trips-ahead-container error\",children:[\"Error: \",error]});}return/*#__PURE__*/_jsxs(\"div\",{className:\"trips-ahead-container\",children:[/*#__PURE__*/_jsx(\"div\",{className:\"trips-header\",children:/*#__PURE__*/_jsx(\"h3\",{children:\"Your Upcoming Trips\"})}),bookings.length===0?/*#__PURE__*/_jsx(\"p\",{children:\"No upcoming trips found.\"}):/*#__PURE__*/_jsx(\"div\",{className:\"trips-list\",children:bookings.map(booking=>/*#__PURE__*/_jsxs(\"div\",{className:\"trip-item\",children:[/*#__PURE__*/_jsxs(\"h4\",{children:[\"Booking Reference: \",booking.booking_reference]}),booking.flights&&/*#__PURE__*/_jsxs(_Fragment,{children:[/*#__PURE__*/_jsxs(\"p\",{children:[\"Flight: \",booking.flights.flight_number||booking.flight_id]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"From: \",booking.flights.origin||'N/A',\" To: \",booking.flights.destination||'N/A']}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Departure: \",booking.flights.departure_time?new Date(booking.flights.departure_time).toLocaleString():'N/A']})]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Passenger: \",booking.passenger_name]}),/*#__PURE__*/_jsxs(\"p\",{children:[\"Price: $\",booking.total_price]})]},booking.id))}),/*#__PURE__*/_jsx(\"button\",{onClick:onClose,className:\"close-trips-button\",children:\"Close\"})]});};export default TripsAhead;","map":{"version":3,"names":["React","useState","useEffect","useAuth","getBookingsByUserId","jsx","_jsx","jsxs","_jsxs","Fragment","_Fragment","TripsAhead","_ref","onClose","user","bookings","setBookings","loading","setLoading","error","setError","fetchTrips","data","id","err","console","className","children","length","map","booking","booking_reference","flights","flight_number","flight_id","origin","destination","departure_time","Date","toLocaleString","passenger_name","total_price","onClick"],"sources":["C:/Users/as999/Desktop/Flight/frontend/src/components/TripsAhead.js"],"sourcesContent":["import React, { useState, useEffect } from 'react';\nimport { useAuth } from '../hooks/useAuth';\nimport { getBookingsByUserId } from '../services/api';\nimport './TripsAhead.css';\n\nconst TripsAhead = ({ onClose }) => {\n  const user = useAuth();\n  const [bookings, setBookings] = useState([]);\n  const [loading, setLoading] = useState(true);\n  const [error, setError] = useState(null);\n\n  useEffect(() => {\n    const fetchTrips = async () => {\n      if (!user) {\n        setLoading(false);\n        setError(\"User not logged in.\");\n        return;\n      }\n      setLoading(true);\n      setError(null);\n      try {\n        // Fetch bookings for the logged-in user\n        // Assuming getBookingsByUserId exists and takes user.id\n        const data = await getBookingsByUserId(user.id);\n        setBookings(data);\n      } catch (err) {\n        console.error('Error fetching trips:', err);\n        setError('Failed to load your trips.');\n      } finally {\n        setLoading(false);\n      }\n    };\n\n    // Only fetch if the user is logged in and the component is visible\n    if (user) {\n      fetchTrips();\n    }\n\n  }, [user]); // Refetch if user changes\n\n  if (!user) {\n      // This case should ideally not be reached due to ProtectedRoute,\n      // but handling it prevents errors if state is weird.\n      return <div className=\"trips-ahead-container error\">Please sign in to see your trips.</div>;\n  }\n\n  if (loading) {\n    return <div className=\"trips-ahead-container\">Loading trips...</div>;\n  }\n\n  if (error) {\n    return <div className=\"trips-ahead-container error\">Error: {error}</div>;\n  }\n\n  return (\n    <div className=\"trips-ahead-container\">\n      <div className=\"trips-header\">\n        <h3>Your Upcoming Trips</h3>\n        {/* Add a close button if needed */}\n        {/* <button onClick={onClose}>Close</button> */}\n      </div>\n      {bookings.length === 0 ? (\n        <p>No upcoming trips found.</p>\n      ) : (\n        <div className=\"trips-list\">\n          {bookings.map(booking => (\n            <div key={booking.id} className=\"trip-item\">\n              <h4>Booking Reference: {booking.booking_reference}</h4>\n              {/* Display flight details if they are included in the booking data fetched by the backend */}\n              {/* You might need to adjust the backend endpoint to JOIN flights table */}\n              {/* Check if flight data exists and is an array/object before accessing */}\n              {booking.flights && (\n                <>\n                  <p>Flight: {booking.flights.flight_number || booking.flight_id}</p>\n                  <p>From: {booking.flights.origin || 'N/A'} To: {booking.flights.destination || 'N/A'}</p>\n                  <p>Departure: {booking.flights.departure_time ? new Date(booking.flights.departure_time).toLocaleString() : 'N/A'}</p>\n                </>\n              )}\n              \n              <p>Passenger: {booking.passenger_name}</p>\n              <p>Price: ${booking.total_price}</p>\n              {/* Add more booking details as needed */}\n            </div>\n          ))}\n        </div>\n      )}\n      <button onClick={onClose} className=\"close-trips-button\">Close</button>\n    </div>\n  );\n};\n\nexport default TripsAhead; "],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}