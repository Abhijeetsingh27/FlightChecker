{"ast":null,"code":"import axios from'axios';const AMADEUS_API_URL='https://test.api.amadeus.com/v2';class AmadeusService{constructor(){this.accessToken=null;this.tokenExpiration=null;}async getAccessToken(){const clientId=process.env.REACT_APP_AMADEUS_CLIENT_ID;const clientSecret=process.env.REACT_APP_AMADEUS_CLIENT_SECRET;// Debug logging\nconsole.log('Amadeus Client ID:',clientId?'Present':'Missing');console.log('Amadeus Client Secret:',clientSecret?'Present':'Missing');if(!clientId||!clientSecret){throw new Error('Amadeus API credentials are missing. Please check your .env file.');}if(this.accessToken&&this.tokenExpiration>Date.now()){return this.accessToken;}try{const response=await axios.post('https://test.api.amadeus.com/v1/security/oauth2/token',new URLSearchParams({grant_type:'client_credentials',client_id:clientId,client_secret:clientSecret}),{headers:{'Content-Type':'application/x-www-form-urlencoded'}});this.accessToken=response.data.access_token;this.tokenExpiration=Date.now()+response.data.expires_in*1000;return this.accessToken;}catch(error){var _error$response,_error$response$data;const errorMessage=((_error$response=error.response)===null||_error$response===void 0?void 0:(_error$response$data=_error$response.data)===null||_error$response$data===void 0?void 0:_error$response$data.error_description)||error.message;console.error('Error getting Amadeus access token:',errorMessage);throw new Error(\"Failed to authenticate with Amadeus API: \".concat(errorMessage));}}async searchFlights(originLocationCode,destinationLocationCode,departureDate,returnDate){let adults=arguments.length>4&&arguments[4]!==undefined?arguments[4]:1;let cabinClass=arguments.length>5&&arguments[5]!==undefined?arguments[5]:'ECONOMY';try{const token=await this.getAccessToken();const response=await axios.get(\"\".concat(AMADEUS_API_URL,\"/shopping/flight-offers\"),{headers:{Authorization:\"Bearer \".concat(token)},params:{originLocationCode,destinationLocationCode,departureDate,returnDate,adults,currencyCode:'USD',max:10,travelClass:cabinClass}});return response.data;}catch(error){var _error$response2,_error$response2$data,_error$response2$data2,_error$response2$data3;const errorMessage=((_error$response2=error.response)===null||_error$response2===void 0?void 0:(_error$response2$data=_error$response2.data)===null||_error$response2$data===void 0?void 0:(_error$response2$data2=_error$response2$data.errors)===null||_error$response2$data2===void 0?void 0:(_error$response2$data3=_error$response2$data2[0])===null||_error$response2$data3===void 0?void 0:_error$response2$data3.detail)||error.message;console.error('Error searching flights:',errorMessage);throw new Error(\"Failed to search flights: \".concat(errorMessage));}}async getFlightOffersPrice(offer){try{const token=await this.getAccessToken();const response=await axios.post(\"\".concat(AMADEUS_API_URL,\"/shopping/flight-offers/pricing\"),{data:{type:'flight-offers-pricing',flightOffers:[offer]}},{headers:{Authorization:\"Bearer \".concat(token),'Content-Type':'application/json'}});return response.data;}catch(error){var _error$response3,_error$response3$data,_error$response3$data2,_error$response3$data3;const errorMessage=((_error$response3=error.response)===null||_error$response3===void 0?void 0:(_error$response3$data=_error$response3.data)===null||_error$response3$data===void 0?void 0:(_error$response3$data2=_error$response3$data.errors)===null||_error$response3$data2===void 0?void 0:(_error$response3$data3=_error$response3$data2[0])===null||_error$response3$data3===void 0?void 0:_error$response3$data3.detail)||error.message;console.error('Error getting flight price:',errorMessage);throw new Error(\"Failed to get flight price: \".concat(errorMessage));}}}const amadeusService=new AmadeusService();export default amadeusService;","map":{"version":3,"names":["axios","AMADEUS_API_URL","AmadeusService","constructor","accessToken","tokenExpiration","getAccessToken","clientId","process","env","REACT_APP_AMADEUS_CLIENT_ID","clientSecret","REACT_APP_AMADEUS_CLIENT_SECRET","console","log","Error","Date","now","response","post","URLSearchParams","grant_type","client_id","client_secret","headers","data","access_token","expires_in","error","_error$response","_error$response$data","errorMessage","error_description","message","concat","searchFlights","originLocationCode","destinationLocationCode","departureDate","returnDate","adults","arguments","length","undefined","cabinClass","token","get","Authorization","params","currencyCode","max","travelClass","_error$response2","_error$response2$data","_error$response2$data2","_error$response2$data3","errors","detail","getFlightOffersPrice","offer","type","flightOffers","_error$response3","_error$response3$data","_error$response3$data2","_error$response3$data3","amadeusService"],"sources":["C:/Users/as999/Desktop/React/Flight/frontend/src/services/amadeusService.js"],"sourcesContent":["import axios from 'axios';\r\n\r\nconst AMADEUS_API_URL = 'https://test.api.amadeus.com/v2';\r\n\r\nclass AmadeusService {\r\n  constructor() {\r\n    this.accessToken = null;\r\n    this.tokenExpiration = null;\r\n  }\r\n\r\n  async getAccessToken() {\r\n    const clientId = process.env.REACT_APP_AMADEUS_CLIENT_ID;\r\n    const clientSecret = process.env.REACT_APP_AMADEUS_CLIENT_SECRET;\r\n\r\n    // Debug logging\r\n    console.log('Amadeus Client ID:', clientId ? 'Present' : 'Missing');\r\n    console.log('Amadeus Client Secret:', clientSecret ? 'Present' : 'Missing');\r\n\r\n    if (!clientId || !clientSecret) {\r\n      throw new Error('Amadeus API credentials are missing. Please check your .env file.');\r\n    }\r\n\r\n    if (this.accessToken && this.tokenExpiration > Date.now()) {\r\n      return this.accessToken;\r\n    }\r\n\r\n    try {\r\n      const response = await axios.post(\r\n        'https://test.api.amadeus.com/v1/security/oauth2/token',\r\n        new URLSearchParams({\r\n          grant_type: 'client_credentials',\r\n          client_id: clientId,\r\n          client_secret: clientSecret,\r\n        }),\r\n        {\r\n          headers: {\r\n            'Content-Type': 'application/x-www-form-urlencoded',\r\n          },\r\n        }\r\n      );\r\n\r\n      this.accessToken = response.data.access_token;\r\n      this.tokenExpiration = Date.now() + response.data.expires_in * 1000;\r\n      return this.accessToken;\r\n    } catch (error) {\r\n      const errorMessage = error.response?.data?.error_description || error.message;\r\n      console.error('Error getting Amadeus access token:', errorMessage);\r\n      throw new Error(`Failed to authenticate with Amadeus API: ${errorMessage}`);\r\n    }\r\n  }\r\n\r\n  async searchFlights(originLocationCode, destinationLocationCode, departureDate, returnDate, adults = 1, cabinClass = 'ECONOMY') {\r\n    try {\r\n      const token = await this.getAccessToken();\r\n      const response = await axios.get(`${AMADEUS_API_URL}/shopping/flight-offers`, {\r\n        headers: {\r\n          Authorization: `Bearer ${token}`,\r\n        },\r\n        params: {\r\n          originLocationCode,\r\n          destinationLocationCode,\r\n          departureDate,\r\n          returnDate,\r\n          adults,\r\n          currencyCode: 'USD',\r\n          max: 10,\r\n          travelClass: cabinClass,\r\n        },\r\n      });\r\n      return response.data;\r\n    } catch (error) {\r\n      const errorMessage = error.response?.data?.errors?.[0]?.detail || error.message;\r\n      console.error('Error searching flights:', errorMessage);\r\n      throw new Error(`Failed to search flights: ${errorMessage}`);\r\n    }\r\n  }\r\n\r\n  async getFlightOffersPrice(offer) {\r\n    try {\r\n      const token = await this.getAccessToken();\r\n      const response = await axios.post(\r\n        `${AMADEUS_API_URL}/shopping/flight-offers/pricing`,\r\n        { data: { type: 'flight-offers-pricing', flightOffers: [offer] } },\r\n        {\r\n          headers: {\r\n            Authorization: `Bearer ${token}`,\r\n            'Content-Type': 'application/json',\r\n          },\r\n        }\r\n      );\r\n      return response.data;\r\n    } catch (error) {\r\n      const errorMessage = error.response?.data?.errors?.[0]?.detail || error.message;\r\n      console.error('Error getting flight price:', errorMessage);\r\n      throw new Error(`Failed to get flight price: ${errorMessage}`);\r\n    }\r\n  }\r\n}\r\n\r\nconst amadeusService = new AmadeusService();\r\nexport default amadeusService;\r\n"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}